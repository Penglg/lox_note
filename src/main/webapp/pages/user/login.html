<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>lox笔记-登录</title>
</head>
<body>
<div style="text-align: center">
    <h1>登 录</h1>
    <form>
        <label for="u-account">邮箱 </label>
        <input type="text" id="u-account" name="account" placeholder="请输入邮箱"><br><br>
        <label for="u-password">密码 </label>
        <input type="password" id="u-password" name="password" placeholder="请输入密码"><br><br>
        <div>
            <button id="login-btn">登录</button>
        </div>
    </form>
    <br><br>
    <a href="http://localhost:8080/pages/user/register.html">还没有账号？点击此处注册</a>

</div>


<script src="../../js/jquery-3.6.0.js" type="text/javascript"></script>
<script>
    $(document).ready(function(){
        $("#login-btn").click(function () {
            let account = $("#u-account").val();
            let password = $("#u-password").val();

            // 用户邮箱
            let accountPatt = /^([a-z0-9_.-]+)@([\da-z.-]+)\.([a-z.]{2,6})$/;
            if (!accountPatt.test(account)) {
                alert("邮箱不合法！");
                return false;
            }

            let passwordPatt = /^\w{6,15}$/;
            if (!passwordPatt.test(password)) {
                alert("密码不合法！");
                return false;
            }
            $.ajax({
                type:"post",
                url:"/users/login",
                async:false,
                headers:{"Content-Type":"application/json;charset=UTF-8"},
                data: JSON.stringify({
                    "account":account,
                    "password":password
                }),
                dataType:"json",
                success:function (data) {
                    if (data.code === 30001) {
                        alert("登录成功！");
                    } else {
                        alert("登录失败！");
                    }
                },
                error:function () {
                    alert("系统繁忙，稍后再试");
                }
            })
        })
    })


</script>
</body>
</html>